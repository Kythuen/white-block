import{p as c,d as R,a3 as A,a4 as G,v as H,$ as K,b as L,o as w,w as S,r as N,G as O,k as l,K as P,j as p,n as z,a0 as U,N as j,c as k,F as W,B as T,t as X,a5 as q}from"./framework.CDmdpyHB.js";import{w as J,u as Q,a as Y}from"./style.DVjA9Ywn.js";import{d as Z}from"./dom.Ze_sGonF.js";import{u as _}from"./model.B6iaKfeX.js";import{G as ee}from"./event.cVHD4hdA.js";import{_ as te}from"./input.vue_vue_type_script_setup_true_lang.DtSjSdI-.js";import"./theme.CGtRrSKC.js";import{P as oe}from"./index.DA_WeHHL.js";import{C as ae,R as se,D as le,L as ne,S as re}from"./api.DwkIGh4A.js";import ue from"./api.CDmQRylI.js";import"./node.BJaJuXFC.js";import"./api.CDcoq3gP.js";import"./popup.vue_vue_type_script_setup_true_lang._TIyf6r9.js";import"./api.BKqPkQKG.js";function ie(b,D){const t=c(b);function n(d){t.value=d}return[t,n]}const pe=J(te),ce={...re,...ne,...le,...se,...ae,...ue},de=["data-index"],fe={key:1,w:"full",p:"1",flex:"","justify-center":""},Pe=R({name:"WbSelect",inheritAttrs:!1,__name:"select",props:A({options:{},theme:{},icon:{type:Boolean},maxItems:{},inputProps:{},popupProps:{},onSelect:{type:Function},onShow:{type:Function},onHide:{type:Function},size:{},loading:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},clearable:{type:Boolean},value:{},modelValue:{},defaultValue:{},onChange:{type:Function}},ce),emits:["select","show","hide","change","update:value","update:modelValue"],setup(b,{emit:D}){const t=b,n=D,d=Q({valueProps:["size","theme"],nameProps:["arrow"]}),I=Y(()=>{if(t.maxItems&&t.options.length>t.maxItems)return{"--wb-select-max-content-height":`calc(var(--wb-select-height) * ${t.maxItems} + var(--wb-select-padding) * 2 + var(--wb-select-gap) * ${t.maxItems-1})`}}),[f,C]=_({props:G(t)}),[r,u]=ie(!1),h={},g={};t.options&&t.options.forEach((e,o)=>{h[e.value]=e,g[e.value]=o});const v=c(g[f.value]??-1),y=c(h[f.value]),a=c(g[f.value]??-1),i=c(h[f.value]);function x(e,o=!1){var s;t.options&&(a.value=e,i.value=t.options[e],v.value=a.value,y.value=i.value,C((s=i.value)==null?void 0:s.value),o&&u(!1))}function V(e){if(t.options&&r.value)switch(e.code){case"ArrowUp":{if(e.preventDefault(),a.value<=0){a.value=-1;return}a.value-=1,n("select",t.options[a.value].value);break}case"ArrowDown":{if(e.preventDefault(),a.value>=t.options.length){a.value=t.options.length;return}a.value+=1,n("select",t.options[a.value].value);break}case"Escape":u(!1);break;case"Tab":u(!1);break}}const B=ee.get("body");H(()=>{B.on("keydown",V)}),K(()=>{B.off("keydown",V)});function E(e){const{index:o}=e;o&&(x(o-0,!0),u(!1))}function F(e){switch(e.code){case"Enter":{if(!r.value){u(!0);return}v.value=a.value,y.value=i.value,x(a.value,!0);break}case"Space":{e.preventDefault(),r.value||u(!0);break}}}function M(){var e;t.options&&(a.value=v.value,i.value=y.value,n("select",(e=t.options[a.value])==null?void 0:e.value),n("hide"))}return(e,o)=>(w(),L(l(oe),P({modelValue:l(r),"onUpdate:modelValue":o[1]||(o[1]=s=>q(r)?r.value=s:null),size:e.size,placement:"bottom-start",pure:""},e.popupProps,{class:l(d),onShow:o[2]||(o[2]=s=>e.$emit("show")),onHide:M,onKeydown:F}),{content:S(({trigger:s})=>[p("div",{class:z(l(d))},[p("ul",{"max-h":"$wb-select-max-content-height",p:"$wb-select-padding",bg:"$wb-select-background",rounded:"$wb-select-radius",ring:"1 $wb-select-border",flex:"~ col",gap:"$wb-select-gap",overflow:"y-auto",class:"wb-select-content",style:j({minWidth:`${s.width}px`,...l(I)}),onClick:o[0]||(o[0]=U(m=>l(Z)(m,"wb-select-option",E),["stop"]))},[e.options.length?(w(!0),k(W,{key:0},T(e.options,(m,$)=>(w(),k("li",{key:m.value,"data-index":$,relative:"",w:"full",h:"$wb-select-height",bg:"hover:$wb-select-option-hover-background",p:"x-$wb-select-padding",rounded:"$wb-select-radius",flex:"~ none",items:"center",cursor:"pointer",class:z(["wb-select-option",{"wb-select-option--hover":a.value===$,"wb-select-option--active":v.value===$}])},[p("span",null,X(m.label),1)],10,de))),128)):(w(),k("div",fe,o[4]||(o[4]=[p("div",{text:"sm $wb-color-text-5"},"暂无数据",-1)])))],4)],2)]),default:S(()=>[N(e.$slots,"trigger",{},()=>{var s;return[O(l(pe),P({size:e.size},{...e.$attrs,...e.inputProps},{value:(s=i.value)==null?void 0:s.label,readonly:"",class:"wb-select-input"}),{suffix:S(()=>o[3]||(o[3]=[p("i",{w:"$wb-select-arrow",h:"$wb-select-arrow",color:"$wb-color-text-5",i:"heroicons-chevron-down-20-solid"},null,-1)])),_:1},16,["size","value"])]})]),_:3},16,["modelValue","size","class"]))}});export{Pe as default};
